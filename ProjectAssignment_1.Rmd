---
title: "Reproducible Research: Peer Assessment 1"
author: "Alberto A. Caeiro Jr"
output: 
  html_document:
    keep_md: true
---
This project is part of the Johns Hopkins University, offered by Coursera.


### Setting Working Folder
```{r}
setwd('/Users/acaeiro/Developer/Data Science Specialization/RepData_PeerAssessment1')
```

### Loading and preprocessing the data
The dataset is zipped, so we have to unzip it and then load into R.

```{r}
zipFile <- "./activity.zip"
fileList <- unzip(zipFile)
activity <- read.csv(fileList[1], sep=",", header=TRUE)
```

The date column needs to be reformatted to DATE format.
```{r}
activity$date <- as.Date(activity$date, format="%Y-%m-%d")
str(activity)
```

## What is mean total number of steps taken per day?

1. Total numbers of steps taken Each Day (Hist)
```{r} 
byValue=list(Date = activity$date)
aggregatedActivity1 <- aggregate(activity$steps, by=byValue, FUN=sum, na.rm=TRUE)
names(aggregatedActivity1) <- c("Date", "Sum.Of.Steps")
with(aggregatedActivity1, hist(Sum.Of.Steps, col=Date, xlab="Total Steps per Day", main="Total Steps"))
test1 <- 
```

2. Mean total number of steps
```{r}
byValue=list(Date = activity$date)
aggregatedActivity2 <- aggregate(activity$steps, by=byValue, FUN=mean, na.rm=TRUE)
names(aggregatedActivity2) <- c("Date", "Average.Of.Steps")
with(aggregatedActivity2, plot(Date, Average.Of.Steps, ylab="Mean - Daily Total Steps", type="l", main="Average - Steps by Day"))
```

3. Median total number of steps
```{r}
byValue=list(Date = activity$date)
aggregatedActivity3 <- aggregate(activity$steps, by=byValue, FUN=median, na.rm=TRUE)
names(aggregatedActivity3) <- c("Date", "Median.Of.Steps")
with(aggregatedActivity3, plot(Date, Median.Of.Steps, type="l", ylab="Median - Daily Total Steps", 
                               main="Median - Steps by Day"))
```
It makes any sense the median = 0?

## What is the average daily activity pattern?
4. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r}
byValue=list(TimeInterval = activity$interval)
aggregatedActivity4 <- aggregate(activity$steps, by=byValue, FUN=mean, na.rm=TRUE)
names(aggregatedActivity4) <- c("Interval", "Mean.Of.Steps")
with(aggregatedActivity4, plot(Interval, Mean.Of.Steps, type="l", xlab="5 Min Interval", ylab="Average Steps", 
                               main="Average Steps by 5 Min Interval"))
```

5. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
aggregatedActivity4AsMatrix <- cbind(aggregatedActivity4$Mean.Of.Steps, aggregatedActivity4$Interval)
colnames(aggregatedActivity4AsMatrix) <- c("Mean Of Steps", "5 min Interval")
maxNumOfSteps <- max(aggregatedActivity4AsMatrix[,1])
intervalOfMaxSteps <- aggregatedActivity4AsMatrix[(aggregatedActivity4AsMatrix[,1] == maxNumOfSteps),][2]
print(intervalOfMaxSteps)
```

## Inputing missing values
6. Counting and Reporting the number of NA in the dataset
```{r}
sum(is.na(activity$steps))
```


## Are there differences in activity patterns between weekdays and weekends?
